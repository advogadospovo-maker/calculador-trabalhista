<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Acordo Trabalhista Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root { --primary: #2563eb; --secondary: #10b981; --bg: #f8fafc; --card: #ffffff; --text: #1e293b; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: var(--card); padding: 2rem; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        h2 { color: var(--primary); margin-bottom: 1.5rem; text-align: center; }
        .section-title { border-bottom: 2px solid #e2e8f0; margin: 1.5rem 0 1rem; padding-bottom: 0.5rem; font-weight: bold; color: #64748b; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.2rem; margin-bottom: 1rem; }
        .field { display: flex; flex-direction: column; }
        label { font-weight: 600; font-size: 0.85rem; margin-bottom: 0.5rem; }
        input, select { padding: 0.75rem; border: 1px solid #cbd5e1; border-radius: 8px; }
        
        /* Estilo para as listas din√¢micas */
        .dynamic-list { background: #f1f5f9; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; }
        .check-item { display: flex; align-items: center; justify-content: space-between; padding: 8px; border-bottom: 1px solid #e2e8f0; font-size: 0.9rem; }
        .check-item:last-child { border-bottom: none; }
        .check-item input { margin-right: 10px; width: 18px; height: 18px; cursor: pointer; }
        
        .actions { margin-top: 2rem; display: flex; flex-direction: column; gap: 10px; }
        .btn { width: 100%; padding: 1rem; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-calc { background: var(--primary); color: white; }
        .btn-pdf { background: var(--secondary); color: white; display: none; }
        .result-box { margin-top: 2rem; display: none; background: #fff; border: 2px solid var(--primary); padding: 1.5rem; border-radius: 12px; }
        .result-item { display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #f1f5f9; }
        .total-geral { font-size: 1.4rem; font-weight: 800; color: var(--primary); border-top: 2px solid #e2e8f0; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h2>ü§ù Acordo Extrajudicial Inteligente</h2>
    
    <div class="grid">
        <div class="field">
            <label>Data de Admiss√£o</label>
            <input type="date" id="dataAdmissao" onchange="gerarPeriodos()">
        </div>
        <div class="field">
            <label>Data de Demiss√£o</label>
            <input type="date" id="dataDemissao" onchange="gerarPeriodos()">
        </div>
        <div class="field">
            <label>Sal√°rio Base (R$)</label>
            <input type="number" id="salario" value="2500.00" onchange="gerarPeriodos()">
        </div>
        <div class="field">
            <label>Insalubridade (%)</label>
            <select id="insalubridadePerc" onchange="gerarPeriodos()">
                <option value="0">N√£o possui</option>
                <option value="0.10">10% (M√≠nimo)</option>
                <option value="0.20" selected>20% (M√©dio)</option>
                <option value="0.40">40% (M√°ximo)</option>
            </select>
        </div>
    </div>

    <div id="areaPeriodos" style="display:none;">
        <div class="section-title">üìÖ Selecione o que N√ÉO foi pago:</div>
        
        <label>F√©rias (Per√≠odos Aquisitivos)</label>
        <div id="listaFerias" class="dynamic-list"></div>

        <label>13¬∫ Sal√°rios</label>
        <div id="lista13" class="dynamic-list"></div>
    </div>

    <div class="actions">
        <button class="btn btn-calc" onclick="calcularTudo()">Calcular Verbas Selecionadas</button>
        <button class="btn btn-pdf" id="btnPDF">üìÑ Exportar PDF do Acordo</button>
    </div>

    <div class="result-box" id="resultado">
        <div id="detalhe-calculo"></div>
        <div class="result-item total-geral">
            <span>TOTAL DO ACORDO</span>
            <span id="res-total">R$ 0,00</span>
        </div>
    </div>
</div>

<script>
    const SALARIO_MINIMO = 1552.00;
    let periodosCalculados = { ferias: [], decimo: [] };

    function gerarPeriodos() {
        const adm = new Date(document.getElementById('dataAdmissao').value);
        const dem = new Date(document.getElementById('dataDemissao').value);
        const base = parseFloat(document.getElementById('salario').value) + (SALARIO_MINIMO * parseFloat(document.getElementById('insalubridadePerc').value));

        if (isNaN(adm) || isNaN(dem) || dem <= adm) return;

        document.getElementById('areaPeriodos').style.display = 'block';
        const listaFerias = document.getElementById('listaFerias');
        const lista13 = document.getElementById('lista13');
        listaFerias.innerHTML = ""; lista13.innerHTML = "";
        periodosCalculados = { ferias: [], decimo: [] };

        // Gerar F√©rias
        let tempAdm = new Date(adm);
        while (tempAdm < dem) {
            let fimPeriodo = new Date(tempAdm);
            fimPeriodo.setFullYear(fimPeriodo.getFullYear() + 1);
            fimPeriodo.setDate(fimPeriodo.getDate() - 1);

            let label, valor;
            if (fimPeriodo <= dem) {
                label = `${tempAdm.toLocaleDateString()} a ${fimPeriodo.toLocaleDateString()} (Integral)`;
                valor = base * 1.3333;
            } else {
                const mesesProp = Math.floor((dem - tempAdm) / (1000 * 60 * 60 * 24 * 30.44));
                const ajusteProp = (dem.getDate() >= 15) ? mesesProp + 1 : mesesProp;
                label = `${tempAdm.toLocaleDateString()} a ${dem.toLocaleDateString()} (Proporcional ${ajusteProp}/12)`;
                valor = (base / 12 * ajusteProp) * 1.3333;
            }
            
            if(valor > 0) criarItemCheck(listaFerias, label, valor, 'ferias');
            tempAdm.setFullYear(tempAdm.getFullYear() + 1);
        }

        // Gerar 13¬∫
        for (let ano = adm.getFullYear(); ano <= dem.getFullYear(); ano++) {
            let meses = 12;
            if (ano === adm.getFullYear()) meses = 12 - adm.getMonth();
            if (ano === dem.getFullYear()) meses = dem.getMonth() + 1;
            if (dem.getDate() < 15 && ano === dem.getFullYear()) meses--;

            if (meses > 0) {
                const valor = (base / 12) * meses;
                criarItemCheck(lista13, `13¬∫ Sal√°rio de ${ano} (${meses}/12)`, valor, 'decimo');
            }
        }
    }

    function criarItemCheck(container, label, valor, tipo) {
        const div = document.createElement('div');
        div.className = 'check-item';
        const id = Math.random().toString(36).substr(2, 9);
        div.innerHTML = `
            <span><input type="checkbox" data-valor="${valor}" data-label="${label}" class="chk-${tipo}"> ${label}</span>
            <b>R$ ${valor.toFixed(2)}</b>
        `;
        container.appendChild(div);
    }

    function calcularTudo() {
        let total = 0;
        let resumoHtml = "<h3>Verbas a Pagar:</h3>";
        
        // Somar selecionados
        const selecionados = document.querySelectorAll('input[type="checkbox"]:checked');
        
        // Adicionar Aviso Pr√©vio e Multa FGTS automaticamente (opcional, aqui fixo)
        // ... L√≥gica de aviso e FGTS pode ser adicionada aqui ...

        selecionados.forEach(item => {
            const v = parseFloat(item.dataset.valor);
            total += v;
            resumoHtml += `<div class="result-item"><span>${item.dataset.label}</span> <span>R$ ${v.toFixed(2)}</span></div>`;
        });

        document.getElementById('detalhe-calculo').innerHTML = resumoHtml;
        document.getElementById('res-total').innerText = total.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        document.getElementById('resultado').style.display = 'block';
        document.getElementById('btnPDF').style.display = 'block';
    }

    // O c√≥digo do PDF seguiria a mesma l√≥gica de capturar o 'detalhe-calculo'
</script>
</body>
</html>